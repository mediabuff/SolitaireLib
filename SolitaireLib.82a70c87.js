parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"PQuw":[function(require,module,exports) {
"use strict";function o(r){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o})(r)}Object.defineProperty(exports,"__esModule",{value:!0});var r=function(){function r(){}return r.assert=function(o,t){o||r.error(t)},r.error=function(r){if(r=r||"Assert failed","undefined"==typeof Error||o(Error))throw new Error(r);throw r},r}();exports.Debug=r;
},{}],"RU9A":[function(require,module,exports) {
"use strict";var e=this&&this.__values||function(e){var o="function"==typeof Symbol&&Symbol.iterator,t=o&&e[o],n=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(exports,"__esModule",{value:!0});var o=require("~CardLib/Debug"),t=function(){function t(){var o=this;this.touchResponders_=[],this.pxPerRem_=0,this.onResize_=function(){o.refreshUnits_()},this.onWindowMouseMove_=function(t){var n,r,i,s;if(1!==t.buttons)try{for(var a=e(o.touchResponders_),u=a.next();!u.done;u=a.next()){u.value.onTouchUp(-1,!0,t.timeStamp)}}catch(d){n={error:d}}finally{try{u&&!u.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}else try{for(var h=e(o.touchResponders_),c=h.next();!c.done;c=h.next()){c.value.onTouchMoved(-1,t.pageX,t.pageY,t.timeStamp)}}catch(l){i={error:l}}finally{try{c&&!c.done&&(s=h.return)&&s.call(h)}finally{if(i)throw i.error}}},this.onWindowMouseUp_=function(t){var n,r;if(0===t.button)try{for(var i=e(o.touchResponders_),s=i.next();!s.done;s=i.next()){s.value.onTouchUp(-1,!1,t.timeStamp)}}catch(a){n={error:a}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},this.onWindowTouchMove_=function(t){for(var n,r,i=0;i<t.changedTouches.length;++i){var s=t.changedTouches.item(i);if(s)try{for(var a=(n=void 0,e(o.touchResponders_)),u=a.next();!u.done;u=a.next()){u.value.onTouchMoved(s.identifier,s.pageX,s.pageY,t.timeStamp)}}catch(h){n={error:h}}finally{try{u&&!u.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}}},this.onWindowTouchEnd_=function(t){for(var n,r,i=0;i<t.changedTouches.length;++i){var s=t.changedTouches.item(i);if(s)try{for(var a=(n=void 0,e(o.touchResponders_)),u=a.next();!u.done;u=a.next()){u.value.onTouchUp(s.identifier,!1,t.timeStamp)}}catch(h){n={error:h}}finally{try{u&&!u.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}}},this.onWindowTouchCancel_=function(t){for(var n,r,i=0;i<t.changedTouches.length;++i){var s=t.changedTouches.item(i);if(s)try{for(var a=(n=void 0,e(o.touchResponders_)),u=a.next();!u.done;u=a.next()){u.value.onTouchUp(s.identifier,!0,t.timeStamp)}}catch(h){n={error:h}}finally{try{u&&!u.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}}},window.addEventListener("resize",this.onResize_),window.addEventListener("mousemove",this.onWindowMouseMove_),window.addEventListener("mouseup",this.onWindowMouseUp_),window.addEventListener("touchmove",this.onWindowTouchMove_),window.addEventListener("touchend",this.onWindowTouchEnd_),window.addEventListener("touchcancel",this.onWindowTouchCancel_),this.refreshUnits_()}return Object.defineProperty(t.prototype,"pxPerRem",{get:function(){return this.pxPerRem_},enumerable:!0,configurable:!0}),t.prototype.refreshUnits_=function(){var e=getComputedStyle(document.body);this.pxPerRem_=1/parseFloat(e.fontSize)},t.prototype.addTouchResponder=function(e){var t=this.touchResponders_.indexOf(e);o.Debug.assert(t<0),this.touchResponders_.push(e)},t.prototype.removeTouchResponder=function(e){var t=this.touchResponders_.indexOf(e);o.Debug.assert(t>=0),this.touchResponders_.splice(t,1)},t.TOUCH_DEADZONE=5,t.TOUCH_DEADZONE_SQ=25,t}();exports.ViewContext=t;
},{"~CardLib/Debug":"PQuw"}],"U4tK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./ViewContext"),t=function(){return function(t){this.context=new e.ViewContext,this.element=t}}();exports.RootView=t;
},{"./ViewContext":"RU9A"}],"yLxh":[function(require,module,exports) {
"use strict";var e;Object.defineProperty(exports,"__esModule",{value:!0}),function(e){e[e.None=0]="None",e[e.Black=1]="Black",e[e.Red=2]="Red"}(e=exports.Colour||(exports.Colour={}));
},{}],"tmSY":[function(require,module,exports) {
"use strict";var e;Object.defineProperty(exports,"__esModule",{value:!0}),function(e){e[e.None=0]="None",e[e.Ace=1]="Ace",e[e.Two=2]="Two",e[e.Three=3]="Three",e[e.Four=4]="Four",e[e.Five=5]="Five",e[e.Six=6]="Six",e[e.Seven=7]="Seven",e[e.Eight=8]="Eight",e[e.Nine=9]="Nine",e[e.Ten=10]="Ten",e[e.Eleven=11]="Eleven",e[e.Twelve=12]="Twelve",e[e.Thirteen=13]="Thirteen",e[e.Jack=100]="Jack",e[e.Queen=101]="Queen",e[e.King=102]="King"}(e=exports.Rank||(exports.Rank={}));
},{}],"s800":[function(require,module,exports) {
"use strict";var e;Object.defineProperty(exports,"__esModule",{value:!0}),function(e){e[e.None=0]="None",e[e.Spades=1]="Spades",e[e.Hearts=2]="Hearts",e[e.Diamonds=3]="Diamonds",e[e.Clubs=4]="Clubs"}(e=exports.Suit||(exports.Suit={}));
},{}],"CItT":[function(require,module,exports) {
"use strict";var r=this&&this.__values||function(r){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&r[e],t=0;if(n)return n.call(r);if(r&&"number"==typeof r.length)return{next:function(){return r&&t>=r.length&&(r=void 0),{value:r&&r[t++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},e=this&&this.__read||function(r,e){var n="function"==typeof Symbol&&r[Symbol.iterator];if(!n)return r;var t,o,a=n.call(r),i=[];try{for(;(void 0===e||e-- >0)&&!(t=a.next()).done;)i.push(t.value)}catch(l){o={error:l}}finally{try{t&&!t.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}return i};Object.defineProperty(exports,"__esModule",{value:!0});var n=require("./Colour"),t=require("./Rank"),o=require("./Suit"),a=[[o.Suit.Spades,n.Colour.Black],[o.Suit.Hearts,n.Colour.Red],[o.Suit.Diamonds,n.Colour.Red],[o.Suit.Clubs,n.Colour.Black]],i=[t.Rank.Ace,t.Rank.Two,t.Rank.Three,t.Rank.Four,t.Rank.Five,t.Rank.Six,t.Rank.Seven,t.Rank.Eight,t.Rank.Nine,t.Rank.Ten,t.Rank.Jack,t.Rank.Queen,t.Rank.King],l=function(){function n(){}return n.createStandard52Deck=function(n){var t,o,l,u,c=[];try{for(var f=r(a),d=f.next();!d.done;d=f.next()){var y=e(d.value,2),v=y[0],k=y[1];try{for(var s=(l=void 0,r(i)),h=s.next();!h.done;h=s.next()){var R=h.value,S=n.createCard(v,k,R);c.push(S)}}catch(b){l={error:b}}finally{try{h&&!h.done&&(u=s.return)&&u.call(s)}finally{if(l)throw l.error}}}}catch(p){t={error:p}}finally{try{d&&!d.done&&(o=f.return)&&o.call(f)}finally{if(t)throw t.error}}return c},n}();exports.DeckUtils=l;
},{"./Colour":"yLxh","./Rank":"tmSY","./Suit":"s800"}],"esDs":[function(require,module,exports) {
"use strict";var e;Object.defineProperty(exports,"__esModule",{value:!0}),function(e){e[e.None=0]="None",e[e.Quick=1]="Quick",e[e.OneByOne=2]="OneByOne",e[e.Settle=3]="Settle"}(e=exports.DelayHint||(exports.DelayHint={}));
},{}],"Hw5X":[function(require,module,exports) {
"use strict";function e(e,r){for(var t=e,n=[],o=0;o!=r;++o){var s=t.next();n.push(s[0]),t=s[1]}return[n,t]}function r(r,t){return e(r,t)[1]}Object.defineProperty(exports,"__esModule",{value:!0}),exports.generateN=e,exports.skipN=r;
},{}],"vUms":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.congruential32=exports.congruential=void 0;var n=214013,t=2531011,e=4294967295,r=(1<<31)-1,o=function(r){return r*n+t&e},u=function(n){return(n&r)>>16},i=function(){function n(n){this.seed=n}return n.prototype.min=function(){return n.min},n.prototype.max=function(){return n.max},n.prototype.next=function(){var t=o(this.seed);return[u(t),new n(t)]},n.min=0,n.max=Math.pow(2,15)-1,n}(),c=function(){function n(n){this.seed=n}return n.prototype.min=function(){return n.min},n.prototype.max=function(){return n.max},n.prototype.next=function(){var t=o(this.seed),e=u(t),r=o(t),i=u(r),c=o(r);return[2147483648+(u(c)+(i+(e<<15)<<15)+2147483648|0),new n(c)]},n.min=0,n.max=4294967295,n}(),p=function(n){return new i(n)};exports.congruential=p;var a=function(n){return new c(n)};exports.congruential32=a;
},{}],"z9Kq":[function(require,module,exports) {
"use strict";function t(t){return(0|t)>=0?0|t:4294967296+(0|t)}function r(t,r){var e=65535&t,n=65535&r;return e*n+(e*(r>>>16&65535)+(t>>>16&65535)*n<<16)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=n;var e=function(){function e(t,r){r>=e.N?(this.states=e.twist(t),this.index=0):(this.states=t,this.index=r)}return e.twist=function(t){for(var r=t.slice(),n=0;n!==e.N-e.M;++n){var i=(r[n]&e.MASK_UPPER)+(r[n+1]&e.MASK_LOWER);r[n]=r[n+e.M]^i>>>1^-(1&i)&e.A}for(n=e.N-e.M;n!==e.N-1;++n){var s=(r[n]&e.MASK_UPPER)+(r[n+1]&e.MASK_LOWER);r[n]=r[n+e.M-e.N]^s>>>1^-(1&s)&e.A}var o=(r[e.N-1]&e.MASK_UPPER)+(r[0]&e.MASK_LOWER);return r[e.N-1]=r[e.M-1]^o>>>1^-(1&o)&e.A,r},e.seeded=function(t){var n=Array(e.N);n[0]=t;for(var i=1;i!==e.N;++i){var s=n[i-1]^n[i-1]>>>30;n[i]=r(e.F,s)+i|0}return n},e.from=function(t){return new e(e.seeded(t),e.N)},e.prototype.min=function(){return e.min},e.prototype.max=function(){return e.max},e.prototype.next=function(){var r=this.states[this.index];return r^=this.states[this.index]>>>e.U,r^=r<<e.S&e.B,r^=r<<e.T&e.C,[t(r^=r>>>e.L),new e(this.states,this.index+1)]},e.min=0,e.max=4294967295,e.N=624,e.M=397,e.R=31,e.A=2567483615,e.F=1812433253,e.U=11,e.S=7,e.B=2636928640,e.T=15,e.C=4022730752,e.L=18,e.MASK_LOWER=Math.pow(2,e.R)-1,e.MASK_UPPER=Math.pow(2,e.R),e}();function n(t){return e.from(t)}
},{}],"QwVb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.xorshift128plus=void 0;var s=function(){function s(s,t,i,r){this.s01=s,this.s00=t,this.s11=i,this.s10=r}return s.prototype.min=function(){return-2147483648},s.prototype.max=function(){return 2147483647},s.prototype.next=function(){var t=this.s00^this.s00<<23,i=this.s01^(this.s01<<23|this.s00>>>9),r=t^this.s10^(t>>>18|i<<14)^(this.s10>>>5|this.s11<<27),n=i^this.s11^i>>>18^this.s11>>>5;return[this.s00+this.s10|0,new s(this.s11,this.s10,n,r)]},s.prototype.jump=function(){for(var t=this,i=0,r=0,n=0,e=0,o=[1667051007,2321340297,1548169110,304075285],h=0;4!==h;++h)for(var u=1;u;u<<=1)o[h]&u&&(i^=t.s01,r^=t.s00,n^=t.s11,e^=t.s10),t=t.next()[1];return new s(i,r,n,e)},s}(),t=function(t){return new s(-1,~t,0|t,0)};exports.xorshift128plus=t;
},{}],"d2X6":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.xoroshiro128plus=void 0;var t=function(){function t(t,s,r,o){this.s01=t,this.s00=s,this.s11=r,this.s10=o}return t.prototype.min=function(){return-2147483648},t.prototype.max=function(){return 2147483647},t.prototype.next=function(){var s=this.s10^this.s00,r=this.s11^this.s01,o=this.s00<<24^this.s01>>>8^s^s<<16,i=this.s01<<24^this.s00>>>8^r^(r<<16|s>>>16),n=r<<5^s>>>27,e=s<<5^r>>>27;return[this.s00+this.s10|0,new t(i,o,e,n)]},t.prototype.jump=function(){for(var s=this,r=0,o=0,i=0,n=0,e=[3639956645,3750757012,1261568508,386426335],u=0;4!==u;++u)for(var h=1;h;h<<=1)e[u]&h&&(r^=s.s01,o^=s.s00,i^=s.s11,n^=s.s10),s=s.next()[1];return new t(r,o,i,n)},t}(),s=function(s){return new t(-1,~s,0|s,0)};exports.xoroshiro128plus=s;
},{}],"BzEQ":[function(require,module,exports) {
"use strict";function n(n,t,r){for(var i=BigInt(r.min()),e=BigInt(r.max()-r.min()+1),o=e,u=BigInt(1);o<t;)o*=e,++u;for(var f=o-o%t,g=r;;){for(var B=BigInt(0),I=BigInt(0);I!==u;++I){var a=g.next();B=e*B+(BigInt(a[0])-i),g=a[1]}if(B<f)return[B-t*(B/t)+n,g]}}function t(t,r,i){var e=r-t+BigInt(1);return null!=i?n(t,e,i):function(r){return n(t,e,r)}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.uniformBigIntDistribution=t;
},{}],"AgQa":[function(require,module,exports) {
"use strict";function r(r,t,n){var o=n.min(),e=n.max()-n.min()+1;if(t<=e)for(var f=n,i=e-e%t;;){var u=(m=f.next())[0]-o;if(f=m[1],u<i)return[u%t+r,f]}for(var a=1,v=0;a<t;)a*=e,++v;for(var l=t*Math.floor(1*a/t),s=n;;){for(var c=0,x=0;x!==v;++x){var m;c=e*c+((m=s.next())[0]-o),s=m[1]}if(c<l)return[c-t*Math.floor(1*c/t)+r,s]}}function t(t,n,o){var e=n-t+1;return null!=o?r(t,e,o):function(n){return r(t,e,n)}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.uniformIntDistribution=t;
},{}],"z2PY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"generateN",{enumerable:!0,get:function(){return e.generateN}}),Object.defineProperty(exports,"skipN",{enumerable:!0,get:function(){return e.skipN}}),Object.defineProperty(exports,"congruential",{enumerable:!0,get:function(){return r.congruential}}),Object.defineProperty(exports,"congruential32",{enumerable:!0,get:function(){return r.congruential32}}),Object.defineProperty(exports,"mersenne",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(exports,"xorshift128plus",{enumerable:!0,get:function(){return n.xorshift128plus}}),Object.defineProperty(exports,"xoroshiro128plus",{enumerable:!0,get:function(){return i.xoroshiro128plus}}),Object.defineProperty(exports,"uniformBigIntDistribution",{enumerable:!0,get:function(){return o.uniformBigIntDistribution}}),Object.defineProperty(exports,"uniformIntDistribution",{enumerable:!0,get:function(){return u.uniformIntDistribution}});var e=require("./generator/RandomGenerator"),r=require("./generator/LinearCongruential"),t=s(require("./generator/MersenneTwister")),n=require("./generator/XorShift"),i=require("./generator/XoroShiro"),o=require("./distribution/UniformBigIntDistribution"),u=require("./distribution/UniformIntDistribution");function s(e){return e&&e.__esModule?e:{default:e}}
},{"./generator/RandomGenerator":"Hw5X","./generator/LinearCongruential":"vUms","./generator/MersenneTwister":"z9Kq","./generator/XorShift":"QwVb","./generator/XoroShiro":"d2X6","./distribution/UniformBigIntDistribution":"BzEQ","./distribution/UniformIntDistribution":"AgQa"}],"HvRb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={};exports.default=void 0;var t=n(require("./pure-rand-default"));function r(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return r=function(){return e},e}function n(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=r();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if(Object.prototype.hasOwnProperty.call(e,u)){var a=o?Object.getOwnPropertyDescriptor(e,u):null;a&&(a.get||a.set)?Object.defineProperty(n,u,a):n[u]=e[u]}return n.default=e,t&&t.set(e,n),n}Object.keys(t).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return t[r]}}))});var o=t;exports.default=o;
},{"./pure-rand-default":"z2PY"}],"C1k7":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../Debug"),n=require("./Rank"),r=require("./Suit"),a=function(){function a(e,n,r,a,t,i){this.pileIndex=0,this.faceUp=!1,this.pileChanged=function(){},this.pileIndexChanged=function(){},this.faceUpChanged=function(){},this.game=e,this.suit=n,this.colour=r,this.rank=a,this.pile=t,this.pileIndex=i}return a.prototype.onPileChanged=function(n,r){this.pile===n?this.onPileIndexChanged(r):(this.pile=n,this.pileIndex=r,this.pile?e.Debug.assert(this.pileIndex===this.pile.indexOf(this)):e.Debug.assert(0===this.pileIndex),this.pileChanged())},a.prototype.onPileIndexChanged=function(n){this.pileIndex!==n&&(this.pileIndex=n,this.pile?e.Debug.assert(this.pileIndex===this.pile.indexOf(this)):e.Debug.assert(0===this.pileIndex),this.pileIndexChanged())},a.prototype.flip=function(e){var n=this;if(this.faceUp!==e){var r=this.faceUp,a=function(){return n.flip_(e)};return this.game.addUndoableOperation(a,function(){return n.flip_(r)}),a()}},a.prototype.flip_=function(e){this.faceUp=e,this.faceUpChanged()},a.prototype.getEmoji=function(){if(!this.faceUp)return"🂠";switch(this.suit){case r.Suit.Spades:switch(this.rank){case n.Rank.Ace:return"🂡";case n.Rank.Two:return"🂢";case n.Rank.Three:return"🂣";case n.Rank.Four:return"🂤";case n.Rank.Five:return"🂥";case n.Rank.Six:return"🂦";case n.Rank.Seven:return"🂧";case n.Rank.Eight:return"🂨";case n.Rank.Nine:return"🂩";case n.Rank.Ten:return"🂪";case n.Rank.Jack:return"🂫";case n.Rank.Queen:return"🂭";case n.Rank.King:return"🂮"}break;case r.Suit.Hearts:switch(this.rank){case n.Rank.Ace:return"🂱";case n.Rank.Two:return"🂲";case n.Rank.Three:return"🂳";case n.Rank.Four:return"🂴";case n.Rank.Five:return"🂵";case n.Rank.Six:return"🂶";case n.Rank.Seven:return"🂷";case n.Rank.Eight:return"🂸";case n.Rank.Nine:return"🂹";case n.Rank.Ten:return"🂺";case n.Rank.Jack:return"🂻";case n.Rank.Queen:return"🂽";case n.Rank.King:return"🂾"}break;case r.Suit.Diamonds:switch(this.rank){case n.Rank.Ace:return"🃁";case n.Rank.Two:return"🃂";case n.Rank.Three:return"🃃";case n.Rank.Four:return"🃄";case n.Rank.Five:return"🃅";case n.Rank.Six:return"🃆";case n.Rank.Seven:return"🃇";case n.Rank.Eight:return"🃈";case n.Rank.Nine:return"🃉";case n.Rank.Ten:return"🃊";case n.Rank.Jack:return"🃋";case n.Rank.Queen:return"🃍";case n.Rank.King:return"🃎"}break;case r.Suit.Clubs:switch(this.rank){case n.Rank.Ace:return"🃑";case n.Rank.Two:return"🃒";case n.Rank.Three:return"🃓";case n.Rank.Four:return"🃔";case n.Rank.Five:return"🃕";case n.Rank.Six:return"🃖";case n.Rank.Seven:return"🃗";case n.Rank.Eight:return"🃘";case n.Rank.Nine:return"🃙";case n.Rank.Ten:return"🃚";case n.Rank.Jack:return"🃛";case n.Rank.Queen:return"🃝";case n.Rank.King:return"🃞"}}return""},a}();exports.Card=a;
},{"../Debug":"PQuw","./Rank":"tmSY","./Suit":"s800"}],"O9cn":[function(require,module,exports) {
"use strict";var t=this&&this.__generator||function(t,e){var r,n,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(a){s=[6,a],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},e=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},r=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,s=r.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(a){i={error:a}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o},n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});var i=n(require("pure-rand")),s=require("../Debug"),o=require("./Card"),a=function(){function n(t){this.cardsChanged=function(){},this.cards_=[],this.game=t}return Object.defineProperty(n.prototype,"length",{get:function(){return this.cards_.length},enumerable:!0,configurable:!0}),n.prototype[Symbol.iterator]=function(){var r,n,i,s,o;return t(this,function(t){switch(t.label){case 0:t.trys.push([0,5,6,7]),r=e(this.cards_),n=r.next(),t.label=1;case 1:return n.done?[3,4]:[4,n.value];case 2:t.sent(),t.label=3;case 3:return n=r.next(),[3,1];case 4:return[3,7];case 5:return i=t.sent(),s={error:i},[3,7];case 6:try{n&&!n.done&&(o=r.return)&&o.call(r)}finally{if(s)throw s.error}return[7];case 7:return[2]}})},n.prototype.createCard=function(t,e,r){var n=new o.Card(this.game,t,e,r,this,this.length-1);return this.cards_.push(n),this.cardsChanged(),n},n.prototype.at=function(t){s.Debug.assert(t>=0&&t<this.cards_.length);var e=this.cards_[t];return s.Debug.assert(e.pile===this),e},n.prototype.slice=function(t,e){return this.cards_.slice(t,e)},n.prototype.indexOf=function(t){return this.cards_.indexOf(t)},n.prototype.sort=function(){this.cards_.sort(function(t,e){return t.suit<e.suit?-1:t.suit>e.suit?1:t.colour<e.colour?-1:t.colour>e.colour?1:t.rank<e.rank?-1:t.rank>e.rank?1:0});for(var t=0;t<this.cards_.length;++t)this.cards_[t].onPileIndexChanged(t);this.cardsChanged()},n.prototype.shuffle=function(t){for(var e,n=0;n<this.cards_.length;++n){var s;s=(e=r(i.default.uniformIntDistribution(n,this.cards_.length-1,t),2))[0],t=e[1];var o=this.cards_[n];this.cards_[n]=this.cards_[s],this.cards_[s]=o}for(n=0;n<this.cards_.length;++n)this.cards_[n].onPileIndexChanged(n);this.cardsChanged()},n.prototype.push=function(t){return this.insert(this.cards_.length,t)},n.prototype.peek=function(){if(!(this.cards_.length<=0))return this.at(this.cards_.length-1)},n.prototype.insert=function(t,e){var r=this,n=e.pile,i=e.pileIndex,s=function(){return r.insert_(t,e)};return this.game.addUndoableOperation(s,function(){return n.insert_(i,e)}),s()},n.prototype.insert_=function(t,e){s.Debug.assert(t>=0&&t<=this.cards_.length),e.pile===this&&t>=e.pileIndex&&t--,e.pile.remove_(e),this.cards_.splice(t,0,e),e.onPileChanged(this,t);for(var r=t+1;r<this.cards_.length;++r)this.cards_[r].onPileIndexChanged(r);return this.cardsChanged(),e},n.prototype.remove_=function(t){s.Debug.assert(t.pile===this);var e=t.pileIndex;s.Debug.assert(this.at(e)===t),this.cards_.splice(e,1);for(var r=e;r<this.cards_.length;++r)this.cards_[r].onPileIndexChanged(r);return this.cardsChanged(),t},n}();exports.Pile=a;
},{"pure-rand":"HvRb","../Debug":"PQuw","./Card":"C1k7"}],"KVv4":[function(require,module,exports) {
"use strict";var t=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(){this.redos_=[],this.undos_=[]}return Object.defineProperty(e.prototype,"length",{get:function(){return this.undos_.length},enumerable:!0,configurable:!0}),e.prototype.addOperation=function(t,e){this.redos_.push(t),this.undos_.push(e)},e.prototype.undo=function(){for(var t=this.undos_.length;t-- >0;)this.undos_[t]()},e.prototype.redo=function(){var e,r;try{for(var o=t(this.redos_),n=o.next();!n.done;n=o.next()){(0,n.value)()}}catch(i){e={error:i}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},e}();exports.UndoableOperation=e;
},{}],"XwaN":[function(require,module,exports) {
"use strict";var t=this&&this.__generator||function(t,e){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},e=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});var n=r(require("pure-rand")),i=require("../Debug"),o=require("./Card"),a=require("./Pile"),s=require("./UndoableOperation"),u=function(){function r(){this.cards=[],this.piles=[],this.undoStack_=[],this.redoStack_=[],this.currentOperation_=void 0}return r.prototype.restart=function(r){var i;return t(this,function(t){switch(t.label){case 0:return i=n.default.mersenne(r),this.undoStack_=[],this.redoStack_=[],this.currentOperation_=void 0,[5,e(this.restart_(i))];case 1:return t.sent(),[2]}})},Object.defineProperty(r.prototype,"canUndo",{get:function(){return this.undoStack_.length>0},enumerable:!0,configurable:!0}),r.prototype.undo=function(){var e;return t(this,function(t){return(e=this.undoStack_.pop())&&(e.undo(),this.redoStack_.push(e)),[2]})},Object.defineProperty(r.prototype,"canRedo",{get:function(){return this.redoStack_.length>0},enumerable:!0,configurable:!0}),r.prototype.redo=function(){var e;return t(this,function(t){return(e=this.redoStack_.pop())&&(e.redo(),this.undoStack_.push(e)),[2]})},r.prototype.getHint=function(){throw new Error("Method not implemented.")},r.prototype.pilePrimary=function(r){return t(this,function(t){switch(t.label){case 0:return this.startOperation_()?(r instanceof a.Pile||i.Debug.error(),i.Debug.assert(this.piles.indexOf(r)>=0),[5,e(this.pilePrimary_(r))]):[3,2];case 1:t.sent(),this.commitOperation_(),t.label=2;case 2:return[2]}})},r.prototype.pileSecondary=function(r){return t(this,function(t){switch(t.label){case 0:return this.startOperation_()?(r instanceof a.Pile||i.Debug.error(),i.Debug.assert(this.piles.indexOf(r)>=0),[5,e(this.pileSecondary_(r))]):[3,2];case 1:t.sent(),this.commitOperation_(),t.label=2;case 2:return[2]}})},r.prototype.cardPrimary=function(r){return t(this,function(t){switch(t.label){case 0:return this.startOperation_()?(r instanceof o.Card||i.Debug.error(),i.Debug.assert(this.cards.indexOf(r)>=0),[5,e(this.cardPrimary_(r))]):[3,2];case 1:t.sent(),this.commitOperation_(),t.label=2;case 2:return[2]}})},r.prototype.cardSecondary=function(r){return t(this,function(t){switch(t.label){case 0:return this.startOperation_()?(r instanceof o.Card||i.Debug.error(),i.Debug.assert(this.cards.indexOf(r)>=0),[5,e(this.cardSecondary_(r))]):[3,2];case 1:t.sent(),this.commitOperation_(),t.label=2;case 2:return[2]}})},r.prototype.canDrag=function(t){return t instanceof o.Card||i.Debug.error(),i.Debug.assert(this.cards.indexOf(t)>=0),this.canDrag_(t)},r.prototype.previewDrop=function(t,e){return t instanceof o.Card||i.Debug.error(),e instanceof a.Pile||i.Debug.error(),i.Debug.assert(this.cards.indexOf(t)>=0),i.Debug.assert(this.piles.indexOf(e)>=0),this.previewDrop_(t,e)},r.prototype.dropCard=function(r,n){return t(this,function(t){switch(t.label){case 0:return this.startOperation_()?(r instanceof o.Card||i.Debug.error(),n instanceof a.Pile||i.Debug.error(),i.Debug.assert(this.cards.indexOf(r)>=0),i.Debug.assert(this.piles.indexOf(n)>=0),[5,e(this.dropCard_(r,n))]):[3,2];case 1:t.sent(),this.commitOperation_(),t.label=2;case 2:return[2]}})},r.prototype.startOperation_=function(){return!this.currentOperation_&&(this.currentOperation_=new s.UndoableOperation,!0)},r.prototype.addUndoableOperation=function(t,e){this.currentOperation_&&this.currentOperation_.addOperation(t,e)},r.prototype.commitOperation_=function(){this.currentOperation_||i.Debug.error(),this.currentOperation_.length>0&&(this.undoStack_.push(this.currentOperation_),this.redoStack_=[]),this.currentOperation_=void 0},r}();exports.GameBase=u;
},{"pure-rand":"HvRb","../Debug":"PQuw","./Card":"C1k7","./Pile":"O9cn","./UndoableOperation":"KVv4"}],"EbBE":[function(require,module,exports) {
"use strict";var e=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),t=this&&this.__generator||function(e,t){var r,n,a,s,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(s){return function(i){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&s[0]?n.return:s[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,s[1])).done)return a;switch(n=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(i){s=[6,i],n=0}finally{r=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,i])}}},r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(exports,"__esModule",{value:!0});var n=require("~CardLib/Debug"),a=require("~CardLib/Model/DeckUtils"),s=require("~CardLib/Model/DelayHint"),o=require("~CardLib/Model/GameBase"),i=require("~CardLib/Model/Pile"),u=require("~CardLib/Model/Rank"),l=7,c=function(o){function c(e){var t=o.call(this)||this;t.stock=new i.Pile(t),t.waste=new i.Pile(t),t.foundations=[],t.tableaux=[],t.dragSingleSources_=[],t.autoMoveSources_=[],t.restocks_=0,t.options=e,t.piles.push(t.stock),t.piles.push(t.waste),t.dragSingleSources_.push(t.waste),t.autoMoveSources_.push(t.waste);for(var r=0;r<4;++r){var n=new i.Pile(t);t.foundations.push(n),t.dragSingleSources_.push(n),t.piles.push(n)}for(r=0;r<l;++r){n=new i.Pile(t);t.tableaux.push(n),t.autoMoveSources_.push(n),t.piles.push(n)}return t.cards=a.DeckUtils.createStandard52Deck(t.stock),t}return e(c,o),c.prototype.restart_=function(e){var n,a,o,i,u,l,c,h,f,p;return t(this,function(t){switch(t.label){case 0:this.restocks_=0;try{for(n=r(this.stock),a=n.next();!a.done;a=n.next())(h=a.value).flip(!1)}catch(d){f={error:d}}finally{try{a&&!a.done&&(p=n.return)&&p.call(n)}finally{if(f)throw f.error}}for(o=this.piles.length;o-- >0;)if((l=this.piles[o])!==this.stock)for(i=l.length;i-- >0;)(h=l.at(i)).flip(!1),this.stock.push(h);return this.stock.sort(),this.stock.shuffle(e),[4,s.DelayHint.Settle];case 1:t.sent(),u=0,t.label=2;case 2:if(!(u<this.tableaux.length))return[3,7];l=this.tableaux[u],c=0,t.label=3;case 3:return c<=u?(h=this.stock.peek())?(l.push(h),[4,s.DelayHint.Quick]):[3,5]:[3,6];case 4:t.sent(),t.label=5;case 5:return++c,[3,3];case 6:return++u,[3,2];case 7:return[4,s.DelayHint.OneByOne];case 8:return t.sent(),[5,r(this.doAutoMoves_())];case 9:return t.sent(),[2]}})},c.prototype.cardPrimary_=function(e){var n,a,o,i,u;return t(this,function(t){switch(t.label){case 0:return this.stock.peek()!==e?[3,3]:(this.waste.push(e),[4,s.DelayHint.Quick]);case 1:return t.sent(),e.flip(!0),[5,r(this.doAutoMoves_())];case 2:return t.sent(),[2];case 3:t.trys.push([3,8,9,10]),n=r(this.tableaux),a=n.next(),t.label=4;case 4:return a.done?[3,7]:a.value.peek()!==e||e.faceUp?[3,6]:(e.flip(!0),[5,r(this.doAutoMoves_())]);case 5:return t.sent(),[2];case 6:return a=n.next(),[3,4];case 7:return[3,10];case 8:return o=t.sent(),i={error:o},[3,10];case 9:try{a&&!a.done&&(u=n.return)&&u.call(n)}finally{if(i)throw i.error}return[7];case 10:return[2]}})},c.prototype.cardSecondary_=function(e){var n,a,s,o,i,u,l,c,h,f,p;return t(this,function(t){switch(t.label){case 0:t.trys.push([0,11,12,13]),n=r(this.autoMoveSources_),a=n.next(),t.label=1;case 1:if(a.done)return[3,10];if(a.value.peek()!==e||!e.faceUp)return[3,9];t.label=2;case 2:t.trys.push([2,7,8,9]),f=void 0,s=r(this.foundations),o=s.next(),t.label=3;case 3:return o.done?[3,6]:(i=o.value,this.isFoundationDrop_(e,i)?(i.push(e),[5,r(this.doAutoMoves_())]):[3,5]);case 4:return t.sent(),[2];case 5:return o=s.next(),[3,3];case 6:return[3,9];case 7:return u=t.sent(),f={error:u},[3,9];case 8:try{o&&!o.done&&(p=s.return)&&p.call(s)}finally{if(f)throw f.error}return[7];case 9:return a=n.next(),[3,1];case 10:return[3,13];case 11:return l=t.sent(),c={error:l},[3,13];case 12:try{a&&!a.done&&(h=n.return)&&h.call(n)}finally{if(c)throw c.error}return[7];case 13:return[2]}})},c.prototype.pilePrimary_=function(e){var n,a;return t(this,function(t){switch(t.label){case 0:if(!(e===this.stock&&0===this.stock.length&&this.waste.length>0&&this.restocks_<this.options.restocksAllowed))return[3,4];for(this.restocks_++,n=this.waste.length;n-- >0;)(a=this.waste.at(n)).flip(!1);return[4,s.DelayHint.OneByOne];case 1:for(t.sent(),n=this.waste.length;n-- >0;)a=this.waste.at(n),this.stock.push(a);return[4,s.DelayHint.OneByOne];case 2:return t.sent(),[5,r(this.doAutoMoves_())];case 3:return t.sent(),[2];case 4:return[2]}})},c.prototype.pileSecondary_=function(e){return t(this,function(e){return[2]})},c.prototype.canDrag_=function(e){var t,n,a,s;try{for(var o=r(this.dragSingleSources_),i=o.next();!i.done;i=o.next()){if((c=i.value).peek()===e)return{canDrag:!0,extraCards:[]}}}catch(h){t={error:h}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}try{for(var u=r(this.tableaux),l=u.next();!l.done;l=u.next()){var c=l.value;if(e.pile===c&&e.faceUp)return{canDrag:!0,extraCards:c.slice(e.pileIndex+1)}}}catch(f){a={error:f}}finally{try{l&&!l.done&&(s=u.return)&&s.call(u)}finally{if(a)throw a.error}}return{canDrag:!1,extraCards:[]}},c.prototype.previewDrop_=function(e,t){return this.isTableauxDrop_(e,t)||this.isFoundationDrop_(e,t)},c.prototype.dropCard_=function(e,n){var a,s,o,i,u,l;return t(this,function(t){switch(t.label){case 0:if(!this.isTableauxDrop_(e,n))return[3,2];a=e.pile.slice(e.pileIndex);try{for(s=r(a),o=s.next();!o.done;o=s.next())i=o.value,n.push(i)}catch(c){u={error:c}}finally{try{o&&!o.done&&(l=s.return)&&l.call(s)}finally{if(u)throw u.error}}return[5,r(this.doAutoMoves_())];case 1:return t.sent(),[3,4];case 2:return this.isFoundationDrop_(e,n)?(n.push(e),[5,r(this.doAutoMoves_())]):[3,4];case 3:t.sent(),t.label=4;case 4:return[2]}})},c.prototype.isTableauxDrop_=function(e,t){if(e.pile===t)return!1;if(this.tableaux.indexOf(t)>=0){var r=t.peek();if(r){if(this.getCardValue_(r)===this.getCardValue_(e)+1&&r.colour!==e.colour)return!0}else if(e.rank===u.Rank.King)return!0}return!1},c.prototype.isFoundationDrop_=function(e,t){if(e.pile===t)return!1;if(this.foundations.indexOf(t)>=0){var r=t.peek();if(r){if(this.getCardValue_(r)+1===this.getCardValue_(e)&&r.suit===e.suit)return!0}else if(e.rank===u.Rank.Ace)return!0}return!1},c.prototype.getCardValue_=function(e){switch(e.rank){case u.Rank.Ace:return 1;case u.Rank.Two:return 2;case u.Rank.Three:return 3;case u.Rank.Four:return 4;case u.Rank.Five:return 5;case u.Rank.Six:return 6;case u.Rank.Seven:return 7;case u.Rank.Eight:return 8;case u.Rank.Nine:return 9;case u.Rank.Ten:return 10;case u.Rank.Jack:return 11;case u.Rank.Queen:return 12;case u.Rank.King:return 13;default:n.Debug.error()}},c.prototype.doAutoMoves_=function(){var e,n,a,o,i,u,l,c,h,f,p,d,y,v,b,k,_,w,x,g,D,S,M,O;return t(this,function(t){switch(t.label){case 0:if(!this.options.autoReveal)return[3,8];t.label=1;case 1:t.trys.push([1,6,7,8]),_=void 0,e=r(this.tableaux),n=e.next(),t.label=2;case 2:return n.done?[3,5]:(a=n.value,!(k=a.peek())||k.faceUp?[3,4]:[4,s.DelayHint.Quick]);case 3:return t.sent(),k.flip(!0),[3,0];case 4:return n=e.next(),[3,2];case 5:return[3,8];case 6:return o=t.sent(),_={error:o},[3,8];case 7:try{n&&!n.done&&(w=e.return)&&w.call(e)}finally{if(_)throw _.error}return[7];case 8:if(!(this.options.autoMoveToFoundation>0))return[3,22];i=999;try{for(x=void 0,u=r(this.foundations),l=u.next();!l.done;l=u.next())f=l.value,k=f.peek(),i=k?Math.min(i,this.getCardValue_(k)):Math.min(i,0)}catch(C){x={error:C}}finally{try{l&&!l.done&&(g=u.return)&&g.call(u)}finally{if(x)throw x.error}}t.label=9;case 9:t.trys.push([9,20,21,22]),D=void 0,c=r(this.autoMoveSources_),h=c.next(),t.label=10;case 10:if(h.done)return[3,19];if(f=h.value,!((k=f.peek())&&k.faceUp&&this.getCardValue_(k)<=i+this.options.autoMoveToFoundation))return[3,18];t.label=11;case 11:t.trys.push([11,16,17,18]),M=void 0,p=r(this.foundations),d=p.next(),t.label=12;case 12:return d.done?[3,15]:(y=d.value,this.isFoundationDrop_(k,y)?[4,s.DelayHint.OneByOne]:[3,14]);case 13:return t.sent(),y.push(k),[3,0];case 14:return d=p.next(),[3,12];case 15:return[3,18];case 16:return v=t.sent(),M={error:v},[3,18];case 17:try{d&&!d.done&&(O=p.return)&&O.call(p)}finally{if(M)throw M.error}return[7];case 18:return h=c.next(),[3,10];case 19:return[3,22];case 20:return b=t.sent(),D={error:b},[3,22];case 21:try{h&&!h.done&&(S=c.return)&&S.call(c)}finally{if(D)throw D.error}return[7];case 22:return this.options.autoPlayStock&&((k=this.stock.peek())&&0===this.waste.length)?[4,s.DelayHint.OneByOne]:[3,25];case 23:return t.sent(),this.waste.push(k),[4,s.DelayHint.Quick];case 24:return t.sent(),k.flip(!0),[3,0];case 25:return[3,26];case 26:return[2]}})},c}(o.GameBase);exports.Game=c;
},{"~CardLib/Debug":"PQuw","~CardLib/Model/DeckUtils":"CItT","~CardLib/Model/DelayHint":"esDs","~CardLib/Model/GameBase":"XwaN","~CardLib/Model/Pile":"O9cn","~CardLib/Model/Rank":"tmSY"}],"fzbN":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=function(){return function(){this.restocksAllowed=1/0,this.autoReveal=!0,this.autoPlayStock=!0,this.autoMoveToFoundation=2}}();exports.GameOptions=t;
},{}],"jv52":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=function(){function t(t,i,e,s){void 0===t&&(t=0),void 0===i&&(i=0),void 0===e&&(e=0),void 0===s&&(s=0),this.sizeX=t,this.sizeY=i,this.x=e,this.y=s}return Object.defineProperty(t.prototype,"xMin",{get:function(){return this.x-.5*this.sizeX},set:function(t){var i=this.xMax;this.sizeX=i-t,this.x=.5*t+.5*i},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"xMax",{get:function(){return this.x+.5*this.sizeX},set:function(t){var i=this.xMin;this.sizeX=t-i,this.x=.5*i+.5*t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"yMin",{get:function(){return this.y-.5*this.sizeY},set:function(t){var i=this.yMax;this.sizeX=i-t,this.y=.5*t+.5*i},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"yMax",{get:function(){return this.y+.5*this.sizeY},set:function(t){var i=this.yMin;this.sizeX=t-i,this.y=.5*i+.5*t},enumerable:!0,configurable:!0}),t.prototype.set=function(t){return!this.equals(t)&&(this.x=t.x,this.y=t.y,this.sizeX=t.sizeX,this.sizeY=t.sizeY,!0)},t.prototype.setOnElement=function(t){t.style.left="calc(50% + "+(this.x-.5*this.sizeX)+"rem)",t.style.right="calc(50% + "+(-this.x-.5*this.sizeX)+"rem)",t.style.top="calc(50% + "+(this.y-.5*this.sizeY)+"rem)",t.style.bottom="calc(50% + "+(-this.y-.5*this.sizeY)+"rem)"},t.prototype.equals=function(t){return this.x===t.x&&this.y===t.y&&this.sizeX===t.sizeX&&this.sizeY===t.sizeY},t.prototype.overlaps=function(t){var i=Math.min(this.xMax,t.xMax)-Math.max(this.xMin,t.xMin);if(i<=0)return 0;var e=Math.min(this.yMax,t.yMax)-Math.max(this.yMin,t.yMin);return e<=0?0:i*e},t}();exports.Rect=t;
},{}],"bgRm":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../Debug"),t=function(){return function(t,n){this.context=t.context;var r=document.getElementById(n);r instanceof HTMLTemplateElement||e.Debug.error();var o=r.content.firstElementChild;o instanceof HTMLElement||e.Debug.error();var i=document.importNode(o,!0);i instanceof HTMLElement||e.Debug.error(),this.element=i,t.element.appendChild(i)}}();exports.TemplatedElementView=t;
},{"../Debug":"PQuw"}],"rHjd":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),e=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(exports,"__esModule",{value:!0});var r=require("./Rect"),n=require("./TemplatedElementView"),i=require("./ViewContext"),o=function(n){function o(t,e,i,o){var a=n.call(this,t,"cardTemplate")||this;return a.click=function(){},a.dblClick=function(){},a.dragStart=function(){return{canDrag:!1,extraCardViews:[]}},a.dragMoved=function(t){},a.dragEnd=function(t,e){},a.rect_=new r.Rect,a.zIndex_=0,a.faceUp_=!1,a.dropPreview_=!1,a.touchTracking_=!1,a.touchId_=0,a.touchInDeadZone_=!1,a.touchStartX_=0,a.touchStartY_=0,a.lastTouchEndTimeStamp_=0,a.dragging_=!1,a.dragExtraCardViews_=[],a.dragRect_=new r.Rect,a.onMouseDown_=function(t){0===t.button&&(t.preventDefault(),a.context.addTouchResponder(a),a.onTouchDown(-1,t.pageX,t.pageY,t.timeStamp))},a.touchStart_=function(t){for(var e=0;e<t.changedTouches.length;++e){var r=t.changedTouches.item(e);r&&(t.preventDefault(),a.context.addTouchResponder(a),a.onTouchDown(r.identifier,r.pageX,r.pageY,t.timeStamp))}},a.element.classList.add("s"+e+"c"+i+"r"+o),a.element.addEventListener("mousedown",a.onMouseDown_),a.element.addEventListener("touchstart",a.touchStart_),a}return t(o,n),Object.defineProperty(o.prototype,"rect",{get:function(){var t=new r.Rect;return t.set(this.rect_),t},set:function(t){this.rect_.set(t)&&t.setOnElement(this.element)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"zIndex",{get:function(){return this.zIndex_},set:function(t){this.zIndex_!==t&&(this.zIndex_=t,this.element.style.zIndex=""+t)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"faceUp",{get:function(){return this.faceUp_},set:function(t){this.faceUp_!==t&&(this.faceUp_=t,t?this.element.classList.add("faceUp"):this.element.classList.remove("faceUp"))},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"dropPreview",{get:function(){return this.dropPreview_},set:function(t){this.dropPreview_!==t&&(this.dropPreview_=t,t?this.element.classList.add("dropPreview"):this.element.classList.remove("dropPreview"))},enumerable:!0,configurable:!0}),o.prototype.onTouchDown=function(t,e,r,n){this.touchTracking_||(this.touchId_=t,this.touchTracking_=!0,this.touchInDeadZone_=!0,this.touchStartX_=e,this.touchStartY_=r,this.dragging_=!1)},o.prototype.onTouchMoved=function(t,r,n,o){var a,c;if(this.touchTracking_&&this.touchId_===t){var s=r-this.touchStartX_,h=n-this.touchStartY_;if(this.touchInDeadZone_){var d=s*s+h*h;if(d>i.ViewContext.TOUCH_DEADZONE_SQ){var u=Math.sqrt(d);s/=u,h/=u,this.touchStartX_+=i.ViewContext.TOUCH_DEADZONE*s,this.touchStartY_+=i.ViewContext.TOUCH_DEADZONE*h,this.touchInDeadZone_=!1,this.startDragging_()}}if(this.dragging_){this.touchStartX_=r,this.touchStartY_=n;var _=this.context.pxPerRem;this.dragRect_.x+=_*s,this.dragRect_.y+=_*h,this.dragRect_.setOnElement(this.element);try{for(var l=e(this.dragExtraCardViews_),g=l.next();!g.done;g=l.next()){var f=g.value;f.dragRect_.x+=_*s,f.dragRect_.y+=_*h,f.dragRect_.setOnElement(f.element)}}catch(p){a={error:p}}finally{try{g&&!g.done&&(c=l.return)&&c.call(l)}finally{if(a)throw a.error}}this.dragMoved(this.dragRect_)}}},o.prototype.onTouchUp=function(t,e,r){this.touchTracking_&&this.touchId_===t&&(this.touchTracking_=!1,this.context.removeTouchResponder(this),this.touchInDeadZone_?(r<this.lastTouchEndTimeStamp_+1e3?(this.dblClick(),r=0):this.click(),this.stopDragging_(!0)):this.stopDragging_(!1),this.lastTouchEndTimeStamp_=r)},o.prototype.startDragging_=function(){var t,r,n=this.dragStart(),i=n.canDrag,o=n.extraCardViews;if(i){this.dragging_=!0,this.dragExtraCardViews_=o,this.dragRect_.set(this.rect_),this.element.classList.add("dragging");try{for(var a=e(this.dragExtraCardViews_),c=a.next();!c.done;c=a.next()){var s=c.value;s.dragRect_.set(s.rect_),s.element.classList.add("dragging")}}catch(h){t={error:h}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}}},o.prototype.stopDragging_=function(t){var r,n;if(this.dragging_){this.dragging_=!1,this.element.classList.remove("dragging"),this.rect_.setOnElement(this.element);try{for(var i=e(this.dragExtraCardViews_),o=i.next();!o.done;o=i.next()){var a=o.value;a.element.classList.remove("dragging"),a.rect_.setOnElement(a.element)}}catch(c){r={error:c}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}this.dragEnd(this.dragRect_,t)}},o}(n.TemplatedElementView);exports.CardView=o;
},{"./Rect":"jv52","./TemplatedElementView":"bgRm","./ViewContext":"RU9A"}],"TjZC":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./Rect"),o=require("./TemplatedElementView"),n=require("./ViewContext"),r=function(o){function r(t){var n=o.call(this,t,"pileTemplate")||this;return n.click=function(){},n.dblClick=function(){},n.fanXDown=0,n.fanXUp=0,n.fanYDown=0,n.fanYUp=0,n.cardCount=0,n.rect_=new e.Rect,n.hitbox_=new e.Rect,n.zIndex_=0,n.showFrame_=!1,n.dropPreview_=!1,n.touchTracking_=!1,n.touchId_=0,n.touchInDeadZone_=!1,n.touchStartX_=0,n.touchStartY_=0,n.lastTouchEndTimeStamp_=0,n.onMouseDown_=function(t){0===t.button&&(t.preventDefault(),n.context.addTouchResponder(n),n.onTouchDown(-1,t.pageX,t.pageY,t.timeStamp))},n.touchStart_=function(t){for(var e=0;e<t.changedTouches.length;++e){var o=t.changedTouches.item(e);o&&(t.preventDefault(),n.context.addTouchResponder(n),n.onTouchDown(o.identifier,o.pageX,o.pageY,t.timeStamp))}},n.element.addEventListener("mousedown",n.onMouseDown_),n.element.addEventListener("touchstart",n.touchStart_),n}return t(r,o),Object.defineProperty(r.prototype,"rect",{get:function(){var t=new e.Rect;return t.set(this.rect_),t},set:function(t){this.rect_.set(t)&&t.setOnElement(this.element)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"hitbox",{get:function(){var t=new e.Rect;return t.set(this.hitbox_),t},set:function(t){this.hitbox_.set(t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"zIndex",{get:function(){return this.zIndex_},set:function(t){this.zIndex_!==t&&(this.zIndex_=t,this.element.style.zIndex=""+t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"showFrame",{get:function(){return this.showFrame_},set:function(t){this.showFrame_!==t&&(this.showFrame_=t,t?this.element.classList.add("showFrame"):this.element.classList.remove("showFrame"))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"dropPreview",{get:function(){return this.dropPreview_},set:function(t){this.dropPreview_!==t&&(this.dropPreview_=t,t?this.element.classList.add("dropPreview"):this.element.classList.remove("dropPreview"))},enumerable:!0,configurable:!0}),r.prototype.onTouchDown=function(t,e,o,n){this.touchTracking_||(this.touchId_=t,this.touchTracking_=!0,this.touchInDeadZone_=!0,this.touchStartX_=e,this.touchStartY_=o)},r.prototype.onTouchMoved=function(t,e,o,r){if(this.touchTracking_&&this.touchId_===t){var i=e-this.touchStartX_,c=o-this.touchStartY_;if(this.touchInDeadZone_){var h=i*i+c*c;if(h>n.ViewContext.TOUCH_DEADZONE_SQ){var s=Math.sqrt(h);i/=s,c/=s,this.touchStartX_+=n.ViewContext.TOUCH_DEADZONE*i,this.touchStartY_+=n.ViewContext.TOUCH_DEADZONE*c,this.touchInDeadZone_=!1}}}},r.prototype.onTouchUp=function(t,e,o){this.touchTracking_&&this.touchId_===t&&(this.touchTracking_=!1,this.context.removeTouchResponder(this),this.touchInDeadZone_&&(o<this.lastTouchEndTimeStamp_+1e3?(this.dblClick(),o=0):this.click()),this.lastTouchEndTimeStamp_=o)},r}(o.TemplatedElementView);exports.PileView=r;
},{"./Rect":"jv52","./TemplatedElementView":"bgRm","./ViewContext":"RU9A"}],"xjDr":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}u((n=n.apply(e,t||[])).next())})},t=this&&this.__generator||function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(exports,"__esModule",{value:!0});var n=require("../Debug"),i=require("../Model/DelayHint"),o=require("../View/CardView"),a=require("../View/PileView"),s=function(){function s(e,t){var r,n,i,o=this;this.pileViews_=[],this.pileToPileView_=new Map,this.pileViewtoPile_=new Map,this.cardViews_=[],this.cardToCardView_=new Map,this.cardViewtoCard_=new Map,this.dropPreview_=void 0,this.nextZIndex_=1e3,this.nextZIndexInc_=1,this.onWindowResize_=function(e){o.onResize_()},this.onWindowKeyDown_=function(e){e&&("y"===e.key&&e.ctrlKey?(o.redo_(),e.stopPropagation(),e.preventDefault()):"z"===e.key&&e.ctrlKey?(o.undo_(),e.stopPropagation(),e.preventDefault()):"n"===e.key&&(o.restart_(),e.stopPropagation(),e.preventDefault()))},this.operations_=[],this.gameBase_=e,this.rootView_=t,null===(r=document.getElementById("newGameButton"))||void 0===r||r.addEventListener("click",function(){o.restart_()}),null===(n=document.getElementById("undoButton"))||void 0===n||n.addEventListener("click",function(){o.undo_()}),null===(i=document.getElementById("redoButton"))||void 0===i||i.addEventListener("click",function(){o.redo_()}),window.addEventListener("resize",this.onWindowResize_),window.addEventListener("keydown",this.onWindowKeyDown_),this.restart_()}return s.prototype.createPileView_=function(e){var t=this,r=new a.PileView(this.rootView_);return this.pileViews_.push(r),this.pileToPileView_.set(e,r),this.pileViewtoPile_.set(r,e),e.cardsChanged=function(){return t.onPileCardsChanged_(r,e)},r.click=function(){return t.pilePrimary_(e)},r.dblClick=function(){return t.pileSecondary_(e)},r},s.prototype.getPile_=function(e){var t=this.pileViewtoPile_.get(e);return t||n.Debug.error(),t},s.prototype.getPileView_=function(e){var t=this.pileToPileView_.get(e);return t||n.Debug.error(),t},s.prototype.onPileCardsChanged_=function(e,t){this.relayoutPile_(e,t)},s.prototype.relayoutPile_=function(e,t){var r;e.cardCount=t.length;for(var n=t.length;n-- >0;){var i=t.at(n),o=this.getCardView_(i);r?o.zIndex=--r:r=o.zIndex}var a=0,s=0,u=0,c=0;for(n=0;n<t.length;++n){i=t.at(n),o=this.getCardView_(i);var d=e.rect;a=u,s=c,d.x+=u,d.y+=c,i.faceUp?(u+=e.fanXUp,c+=e.fanYUp):(u+=e.fanXDown,c+=e.fanYDown),o.rect=d}var h=e.rect;h.x+=.5*a,h.y+=.5*s,h.sizeX+=a,h.sizeY+=s,e.hitbox=h},s.prototype.createCardView_=function(e){var t=this,r=new o.CardView(this.rootView_,e.suit,e.colour,e.rank);return this.cardViews_.push(r),this.cardToCardView_.set(e,r),this.cardViewtoCard_.set(r,e),this.onCardPileChanged_(r,e),e.pileChanged=function(){return t.onCardPileChanged_(r,e)},this.onCardPileIndexChanged_(r,e),e.pileIndexChanged=function(){return t.onCardPileIndexChanged_(r,e)},this.onCardFaceUpChanged_(r,e),e.faceUpChanged=function(){return t.onCardFaceUpChanged_(r,e)},r.click=function(){return t.cardPrimary_(e)},r.dblClick=function(){return t.cardSecondary_(e)},r.dragStart=function(){return t.cardDragStart_(r,e)},r.dragMoved=function(n){return t.cardDragMoved_(r,e,n)},r.dragEnd=function(n,i){return t.cardDragEnd_(r,e,n,i)},r},s.prototype.getCard_=function(e){var t=this.cardViewtoCard_.get(e);return t||n.Debug.error(),t},s.prototype.getCardView_=function(e){var t=this.cardToCardView_.get(e);return t||n.Debug.error(),t},s.prototype.onCardPileChanged_=function(e,t){e.zIndex=this.getNextZIndex_()},s.prototype.onCardPileIndexChanged_=function(e,t){},s.prototype.onCardFaceUpChanged_=function(e,t){e.faceUp=t.faceUp},s.prototype.cardDragStart_=function(e,t){var n,i,o=this.gameBase_.canDrag(t),a=o.canDrag,s=o.extraCards;a&&(e.zIndex=this.getNextZIndex_());var u=[];try{for(var c=r(s),d=c.next();!d.done;d=c.next()){var h=d.value,l=this.getCardView_(h);u.push(l),a&&(l.zIndex=this.getNextZIndex_())}}catch(p){n={error:p}}finally{try{d&&!d.done&&(i=c.return)&&i.call(c)}finally{if(n)throw n.error}}return{canDrag:a,extraCardViews:u}},s.prototype.cardDragMoved_=function(e,t,r){var n=this.getBestDragPile_(t,r);if(n){var i=n.peek();if(i){var o=this.getCardView_(i);return void this.setDropPreview_(o)}var a=this.getPileView_(n);this.setDropPreview_(a)}else this.setDropPreview_(void 0)},s.prototype.cardDragEnd_=function(e,t,r,n){var i=this;if(!n){var o=this.getBestDragPile_(t,r);o&&this.addOperation_(function(){return i.gameBase_.dropCard(t,o)})}this.setDropPreview_(void 0)},s.prototype.getBestDragPile_=function(e,t){var n,i,o,a=0;try{for(var s=r(this.pileViews_),u=s.next();!u.done;u=s.next()){var c=u.value,d=this.getPile_(c),h=c.hitbox,l=t.overlaps(h);l<=0||(!o||a<l)&&this.gameBase_.previewDrop(e,d)&&(o=d,a=l)}}catch(p){n={error:p}}finally{try{u&&!u.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return o},s.prototype.setDropPreview_=function(e){e!==this.dropPreview_&&(this.dropPreview_&&(this.dropPreview_.dropPreview=!1),this.dropPreview_=e,this.dropPreview_&&(this.dropPreview_.dropPreview=!0))},s.prototype.getNextZIndex_=function(){var e=this.nextZIndex_;return this.nextZIndex_+=this.nextZIndexInc_,e},s.prototype.undo_=function(){return e(this,void 0,void 0,function(){var e=this;return t(this,function(t){return this.addOperation_(function(){return e.gameBase_.undo()}),[2]})})},s.prototype.redo_=function(){return e(this,void 0,void 0,function(){var e=this;return t(this,function(t){return this.addOperation_(function(){return e.gameBase_.redo()}),[2]})})},s.prototype.restart_=function(){return e(this,void 0,void 0,function(){var e=this;return t(this,function(t){return this.addOperation_(function(){return e.gameBase_.restart(Date.now())}),[2]})})},s.prototype.pilePrimary_=function(r){return e(this,void 0,void 0,function(){var e=this;return t(this,function(t){return this.addOperation_(function(){return e.gameBase_.pilePrimary(r)}),[2]})})},s.prototype.pileSecondary_=function(r){return e(this,void 0,void 0,function(){var e=this;return t(this,function(t){return this.addOperation_(function(){return e.gameBase_.pileSecondary(r)}),[2]})})},s.prototype.cardPrimary_=function(r){return e(this,void 0,void 0,function(){var e=this;return t(this,function(t){return this.addOperation_(function(){return e.gameBase_.cardPrimary(r)}),[2]})})},s.prototype.cardSecondary_=function(r){return e(this,void 0,void 0,function(){var e=this;return t(this,function(t){return this.addOperation_(function(){return e.gameBase_.cardSecondary(r)}),[2]})})},s.prototype.addOperation_=function(n){return e(this,void 0,void 0,function(){var e,i,o,a,s,u,c,d;return t(this,function(t){switch(t.label){case 0:if(e=0,0!==this.operations_.length)return[3,11];this.operations_.push(n),t.label=1;case 1:if(!(this.operations_.length>0))return[3,10];i=this.operations_[0],t.label=2;case 2:t.trys.push([2,7,8,9]),c=void 0,o=r(i()),a=o.next(),t.label=3;case 3:return a.done?[3,6]:(s=a.value,[4,this.waitForDelay_(s,e++)]);case 4:t.sent(),t.label=5;case 5:return a=o.next(),[3,3];case 6:return[3,9];case 7:return u=t.sent(),c={error:u},[3,9];case 8:try{a&&!a.done&&(d=o.return)&&d.call(o)}finally{if(c)throw c.error}return[7];case 9:return this.operations_.shift(),[3,1];case 10:return[3,12];case 11:this.operations_.push(n),t.label=12;case 12:return[2]}})})},s.prototype.waitForDelay_=function(r,n){return e(this,void 0,void 0,function(){var e;return t(this,function(t){switch(t.label){case 0:switch(e=Math.pow(.95,n),r){case i.DelayHint.None:return[3,1];case i.DelayHint.Quick:return[3,2];case i.DelayHint.OneByOne:return[3,4];case i.DelayHint.Settle:return[3,6]}return[3,8];case 1:return[2];case 2:return[4,new Promise(function(t){return setTimeout(t,20*e)})];case 3:return t.sent(),[2];case 4:return[4,new Promise(function(t){return setTimeout(t,200*e)})];case 5:return t.sent(),[2];case 6:return[4,new Promise(function(t){return setTimeout(t,400*e)})];case 7:return t.sent(),[2];case 8:return[2]}})})},s}();exports.GamePresenterBase=s;
},{"../Debug":"PQuw","../Model/DelayHint":"esDs","../View/CardView":"rHjd","../View/PileView":"TjZC"}],"kIIS":[function(require,module,exports) {
"use strict";var e=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function a(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(a.prototype=r.prototype,new a)}}(),t=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],a=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(exports,"__esModule",{value:!0});var r=require("~CardLib/Presenter/GamePresenterBase"),a=require("~CardLib/View/Rect"),i=1,n=20,o=n/1.555555555555,s=function(r){function s(e,a){var i,n,o=r.call(this,e,a)||this;o.foundationPiles_=[],o.tableauPiles_=[],o.game_=e,(l=o.createPileView_(e.stock)).showFrame=!0,o.stockPile_=l,(l=o.createPileView_(e.waste)).showFrame=!0,l.zIndex=50,o.wastePile_=l;for(var s=0;s<o.game_.foundations.length;++s){(l=o.createPileView_(e.foundations[s])).showFrame=!0,l.zIndex=800,o.foundationPiles_.push(l)}for(s=0;s<o.game_.tableaux.length;++s){var l;(l=o.createPileView_(e.tableaux[s])).showFrame=!0,l.zIndex=800,o.tableauPiles_.push(l)}try{for(var u=t(e.cards),c=u.next();!c.done;c=u.next()){var _=c.value;o.createCardView_(_)}}catch(h){i={error:h}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(i)throw i.error}}return o.layoutPiles_(),o}return e(s,r),s.prototype.onResize_=function(){this.layoutPiles_()},s.prototype.layoutPiles_=function(){var e=this.game_.tableaux.length,t=1;window.matchMedia("screen and (max-aspect-ratio: 100/130)").matches&&(t=1.5);var r=function(t){return(t-.5*(e-1))*(o+i)},s=this.game_.stock;(u=this.getPileView_(s)).rect=new a.Rect(o,n,r(0),-35*t+i),this.relayoutPile_(u,s);s=this.game_.waste;(u=this.getPileView_(this.game_.waste)).rect=new a.Rect(o,n,r(1),-35*t+i),this.relayoutPile_(u,s);for(var l=0;l<this.game_.foundations.length;++l){s=this.game_.foundations[l];(u=this.getPileView_(s)).rect=new a.Rect(o,n,r(e-this.game_.foundations.length+l),-35*t+i),this.relayoutPile_(u,s)}for(l=0;l<this.game_.tableaux.length;++l){var u;s=this.game_.tableaux[l];(u=this.getPileView_(s)).rect=new a.Rect(o,n,r(l),-35*t+i+i+n+i),u.fanYDown=3.5,u.fanYUp=3.5*t,this.relayoutPile_(u,s)}},s}(r.GamePresenterBase);exports.GamePresenter=s;
},{"~CardLib/Presenter/GamePresenterBase":"xjDr","~CardLib/View/Rect":"jv52"}],"QCba":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("~CardLib/View/RootView"),n=require("~Klondike/Model/Game"),r=require("~Klondike/Model/GameOptions"),o=require("~Klondike/Presenter/GamePresenter");window.addEventListener("load",function(){var t,i=null!==(t=document.getElementById("table"))&&void 0!==t?t:document.body,d=new r.GameOptions,a=new n.Game(d),l=new e.RootView(i);new o.GamePresenter(a,l)});
},{"~CardLib/View/RootView":"U4tK","~Klondike/Model/Game":"EbBE","~Klondike/Model/GameOptions":"fzbN","~Klondike/Presenter/GamePresenter":"kIIS"}]},{},["QCba"], null)